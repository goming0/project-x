<div class="admin-container h-100">
  <div class="admin-sidebar h-100">
    <button class="buttonsAdmin" (click)="setActiveBlock('add')" [class.active]="activeBlock === 'add'">Додати</button>
    <button class="buttonsAdmin" (click)="setActiveBlock('delete')" [class.active]="activeBlock === 'delete'">
      Видалити
    </button>
    <!-- <button class="buttonsAdmin">Add</button>
    <button class="buttonsAdmin">Delete</button> -->
  </div>
  <div class="admin-content">
    <form
      class="d-flex flex-column align-items-center active"
      #formAdd="ngForm"
      (ngSubmit)="onSubmit(formAdd)"
      *ngIf="showForm && activeBlock === 'add'">
      <div class="p-4">
        <div class="mb-3 d-flex align-items-center">
          <label for="categoryAdmForm">Категорія:</label>
          <input
            #category="ngModel"
            [(ngModel)]="formData.category"
            type="text"
            placeholder="Jordan*"
            class="form-control ms-2"
            id="category"
            name="categoryAdmForm"
            minlength="2"
            required />
        </div>
        <div style="color: #dc3545" *ngIf="category.invalid && (category.dirty || formAdd.dirty)">
          Будь ласка, введіть категорію.
        </div>
        <div class="mb-3 d-flex align-items-center">
          <label for="titleAdmForm">Найменування продукта:</label>
          <input
            [(ngModel)]="formData.title"
            type="text"
            #title="ngModel"
            placeholder="AIR JORDAN 1 MID*"
            class="form-control ms-2"
            name="title"
            id="titleAdmForm"
            (keydown)="validateLettersAndSpaces($event)"
            minlength="2"
            required />
        </div>
        <div style="color: #dc3545" *ngIf="title.invalid && (title.dirty || formAdd.dirty)">
          Будь ласка, введіть найменування продукта.
        </div>
        <div class="mb-3 d-flex align-items-center">
          <label for="descriptionAdmForm">Опис:</label>
          <input
            [(ngModel)]="formData.description"
            #description="ngModel"
            type="text"
            placeholder="Неймовірні кросівки Nike мають...*"
            class="form-control ms-2"
            name="Назва"
            id="descriptionAdmForm"
            minlength="2"
            (keydown)="validateLettersSpacesAndNumbers($event)"
            required />
        </div>
        <div style="color: #dc3545" *ngIf="description.invalid && (description.dirty || formAdd.dirty)">
          Будь ласка, введіть опис продукта.
        </div>
        <div class="priceSitting">
          <div class="mb-3 d-flex align-items-center">
            <label for="currencyAdmForm">Currency:</label>
            <select
              [(ngModel)]="formData.currency"
              id="currencyAdmForm"
              class="form-control ms-3"
              name="currency"
              required>
              <option value="USD" selected>USD</option>
            </select>
          </div>
          <div class="mb-3 d-flex align-items-center">
            <label for="priceAdmForm">Price:</label>
            <input
              [(ngModel)]="formData.price"
              #price="ngModel"
              type="text"
              inputmode="numeric"
              placeholder="7.42*"
              class="form-control ms-3"
              name="price"
              pattern="\d+(\.\d{1,2})?"
              (keydown)="validateNumbers($event)"
              id="priceAdmForm"
              required />
          </div>
        </div>
        <div class="colorSetting">
          <div class="mb-3 d-flex align-items-center">
            <label for="colorNameAdmForm">Назва коліра:</label>
            <input
              [(ngModel)]="formData.color.name"
              #colorName="ngModel"
              type="text"
              placeholder="White*"
              class="form-control ms-3"
              id="colorNameAdmForm"
              name="colorName"
              pattern=".{1,}"
              required />
          </div>
          <div style="color: #dc3545" *ngIf="colorName.invalid && (colorName.dirty || formAdd.dirty)">
            Будь ласка, введіть назву коліра.
          </div>
          <div class="mb-3 d-flex align-items-center">
            <label for="hexNameAdmForm">Код коліра:</label>
            <input
              [(ngModel)]="formData.color.hex"
              #colorHex="ngModel"
              type="text"
              placeholder="#FFFFFF*"
              class="form-control ms-3"
              name="colorHex"
              id="hexNameAdmForm"
              pattern="#[0-9A-Fa-f]{6}"
              required />
          </div>
          <div style="color: #dc3545" *ngIf="colorHex.invalid && (colorHex.dirty || formAdd.dirty)">
            Будь ласка, введіть код коліра (наприклад #ffffff).
          </div>
        </div>
        <div class="mb-3 sizeBox">
          <h5 class="mb-0">Розміри:</h5>
          <div class="form-check">
            <input
              [(ngModel)]="size8"
              #sizeRef8="ngModel"
              class="form-check-input"
              type="checkbox"
              value="8"
              name="size[]" />
            <label class="form-check-label">8</label>
          </div>
          <div class="form-check">
            <input
              [(ngModel)]="size9"
              #sizeRef9="ngModel"
              class="form-check-input"
              type="checkbox"
              value="9"
              name="sizes[]" />
            <label class="form-check-label">9</label>
          </div>
          <div class="form-check">
            <input
              [(ngModel)]="size10"
              #sizeRef10="ngModel"
              class="form-check-input"
              type="checkbox"
              value="10"
              name="sizes[]" />
            <label class="form-check-label">10</label>
          </div>
          <div class="form-check">
            <input
              [(ngModel)]="size11"
              #sizeRef11="ngModel"
              class="form-check-input"
              type="checkbox"
              value="11"
              name="sizes[]" />
            <label class="form-check-label">11</label>
          </div>
          <div class="form-check">
            <input
              [(ngModel)]="size12"
              #sizeRef12="ngModel"
              class="form-check-input"
              type="checkbox"
              value="12"
              name="sizes[]" />
            <label class="form-check-label">12</label>
          </div>
          <div class="form-check">
            <input
              [(ngModel)]="size13"
              #sizeRef13="ngModel"
              class="form-check-input"
              type="checkbox"
              value="13"
              name="sizes[]" />
            <label class="form-check-label">13</label>
          </div>
          <div class="form-check">
            <input
              [(ngModel)]="size14"
              #sizeRef14="ngModel"
              class="form-check-input"
              type="checkbox"
              value="14"
              name="sizes[]" />
            <label class="form-check-label">14</label>
          </div>
          <div class="form-check">
            <input
              [(ngModel)]="size15"
              #sizeRef15="ngModel"
              class="form-check-input"
              type="checkbox"
              value="15"
              name="sizes[]" />
            <label class="form-check-label">15</label>
          </div>
        </div>
        <div
          style="color: #dc3545"
          *ngIf="
            sizeIsUntouched([sizeRef8, sizeRef9, sizeRef10, sizeRef11, sizeRef12, sizeRef13, sizeRef14, sizeRef15]) &&
            formAdd.dirty
          ">
          Взуття має мати бути хоча б одного розміру.
        </div>

        <div class="ImgAndType__box mb-4 d-flex justify-content-between">
          <!-- Левая колонка - выбор картинок -->
          <div class="imgNewBox d-flex align-items-center">
            <p class="mb-0 me-3">Додати зображення:</p>
            <div class="">
              <label for="fileInput" class="btn-input">Обрати зображення</label>
              <input
                class="file-input"
                id="fileInput"
                #addFiles
                type="file"
                multiple
                (change)="onFileInputChange($event)"
                required />
              <span class="ms-3" *ngIf="selectedFiles.length > 0">{{ selectedFiles.length }} Файл(и) обрані</span>
            </div>
            <div style="color: #dc3545" *ngIf="selectedFiles.length === 0 && formAdd.dirty">
              Повинно бути хоча б одне зображення.
            </div>
          </div>

          <!-- Правая колонка - выбор модели -->
          <div class="typeModel d-flex align-items-center">
            <label for="typeModeleAdmForm">Модель:</label>
            <select
              [(ngModel)]="formData.typeModel"
              id="typeModeleAdmForm"
              class="form-control ms-3"
              name="typeModel"
              required>
              <option value="Sports" selected>Спорт</option>
              <option value="EveryDay">Щоденна</option>
            </select>
          </div>
        </div>

        <p class="text-danger" *ngIf="showErrorMessage">
          Ви не заповнили всі поля, або не обрали розмір, або не загрузили зображення
        </p>
      </div>

      <div class="actions">
        <button
          type="submit"
          class="btn btn-primary btnAdd"
          [disabled]="!formAdd.valid || !isAnySizeSelected() || !isFilesSelected()">
          Додати
        </button>
      </div>
    </form>

    <section class="d-flex w-100 deleteMainBox p-3 flex-column" *ngIf="!showForm && activeBlock === 'delete'">
      <!-- <section class="d-flex w-100 deleteMainBox p-3 flex-column"> -->
      <div class="searcBox w-100 d-flex flex-column align-items-center text-center">
        <h5 class="mb-4">Який продукт ви хочете видалити?</h5>
        <app-search class="seaerchProd w-100 mb-4" (searchChange)="submitSearch($event)"></app-search>

        <div class="categoryFilter mb-4">
          <button class="button__category" (click)="setSelectedCategory('All')">Всі</button>
          <button class="button__category" (click)="setSelectedCategory('Sports')">Спорт</button>
          <button class="button__category" (click)="setSelectedCategory('EveryDay')">Щоденна</button>
        </div>
      </div>
      <div class="boxProduct d-flex flex-wrap w-100">
        <div class="d-flex justify-content-center flex-wrap gap-4">
          <ng-container *ngIf="filteredProducts$ | async as filteredProducts">
            <div class="productItem" *ngFor="let productRef of filteredProducts">
              <div class="productItem ms-3 mb-4 p-1">
                <img class="mb-3" width="200" [src]="productRef.imagesUrls[0]" alt="img" />
                <h4 class="">{{ productRef.title }}</h4>
                <p class="mb-3"><b>Опис:</b> {{ productRef.description | ellipse : 80 }}</p>
                <button class="btn btn-primary" (click)="deleteProduct(productRef)">Видалити</button>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
    </section>
  </div>
</div>
